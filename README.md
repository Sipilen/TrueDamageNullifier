# TrueDamageNullifier

[![GitHub release](https://img.shields.io/github/v/release/sipilen/TrueDamageNullifier?color=blue)](https://github.com/sipilen/TrueDamageNullifier/releases) [![SpigotMC](https://img.shields.io/badge/SpigotMC-Approved-green.svg)](https://www.spigotmc.org/resources/true-damage-nullifier.12345/) [![License](https://img.shields.io/github/license/sipilen/TrueDamageNullifier.svg)](https://github.com/sipilen/TrueDamageNullifier/blob/main/LICENSE)

**TrueDamageNullifier** — мощный плагин для серверов на Bukkit/Spigot (API 1.16+), предназначенный для гибкого управления модификаторами урона в PvP-сражениях. Он позволяет админам отключать, уменьшать или усиливать урон между игроками, с привязкой к UUID (для перманентности), IP-адресу (для альтов) и никам (для простоты). Плагин предотвращает обходы (смена ника/IP/VPN), автоматически отслеживает альт-аккаунты и уведомляет админов о подозрительных входах. Все настройки сохраняются в `config.yml`, временные эффекты истекают автоматически. Сообщения настраиваются в `messages.yml`.

Плагин совместим со старыми конфигурациями и поддерживает автодополнение команд (TAB). Модификаторы применяются только в PvP (игрок vs игрок, включая снаряды); PvE, падения и другие типы урона не затрагиваются.

## Особенности
- **Модификаторы урона:** DISABLED (отключение PvP), REDUCED (снижение в 3 раза), AMPLIFIED (увеличение в 4 раза).
- **Привязки:** Автоматическая к UUID/IP/нику для анти-обхода.
- **Альты:** Отслеживание истории ников по IP, уведомления админам при входе альта с активным модом.
- **Автоматика:** Применение на join, истечение эффектов, авто-bind.
- **Команды:** 15+ команд с TAB-complete, правами и примерами.
- **Конфиг:** YAML, авто-очистка старых данных, reload без рестарта.
- **Лёгкость:** Без зависимостей, низкая нагрузка.

## Установка
1. Скачайте JAR-файл из [релизов](https://github.com/sipilen/TrueDamageNullifier/releases).
2. Поместите в папку `plugins/`.
3. Перезапустите сервер.
4. Настройте права в `permissions.yml` или плагине (LuckPerms).
5. Отредактируйте `messages.yml` (опционально) и перезагрузите `/tdn reload`.

**Зависимости:** Нет (Bukkit/Spigot 1.16+).

## Описание модификаторов урона

Каждый игрок может иметь один из следующих модификаторов, влияющих на PvP-сражения. Модификаторы применяются с приоритетом: UUID (перманентный) > IP (альты) > текущий ник. Если игрок меняет ник или IP, mod следует за ним автоматически.

- **DISABLED**
    - **Действие:** Игрок не может наносить урон другим игрокам (PvP отключён), но может получать урон. Блокирует прямые атаки и снаряды (стрелы и т.д.). При попытке атаки игроку показывается сообщение с причиной и временем.
    - **Применение:** Может быть временным или постоянным (0). Причина обязательна для временных (показывается игроку). Привязка к UUID/IP/нику для отслеживания альтов.
- **REDUCED**
    - **Действие:** Урон, наносимый игроком, снижается на 1/3 (event.setDamage(damage / 3.0)).
    - **Применение:** Может быть временным или постоянным. Причина не указывается. Привязка к UUID/IP/нику.
- **AMPLIFIED**
    - **Действие:** Игрок получает в 4 раза больше урона от других игроков (event.setDamage(damage * 4.0)).
    - **Применение:** Может быть временным или постоянным. Причина не указывается. Привязка к UUID/IP/нику.
- **NORMAL**
    - **Действие:** Модификатор отсутствует, PvP работает стандартно.
    - **Применение:** По умолчанию. Автоматический сброс по истечении времени или команде clear.

**Дополнительно:**
- **Привязки:** Автоматическая (на join/команде): IP/UUID → original nick. Моды сохраняются перманентно.
- **Альты:** Автоматическое отслеживание ников по IP. Уведомления админам при входе альта с активным mod.
- **Истечение:** Автоматически каждую секунду. Сброс с сообщением "PvP включен".

## Команды и права доступа

Для управления модификаторами используются следующие команды и права доступа. Все команды поддерживают автодополнение (TAB): имена игроков, время (30s/1m/1h/0), ники из истории.

### Права доступа

- `tdn.use` — базовое использование (по умолчанию op).
- `tdn.admin` — полный доступ (reload, list, nicklist, уведомления об альтах).
- `tdn.list` — просмотр списка модификаторов игроков.
- `tdn.nicklist` — просмотр списка по никам/IP/альтам.
- `tdn.alts` — просмотр альт-аккаунтов по нику.
- `tdn.clear` — снятие модификаторов с игрока.
- `tdn.nickclear` — снятие по нику/IP.
- `tdn.ipclear` — снятие по IP (через ник).
- `tdn.disable` — отключение урона для игрока.
- `tdn.ipdisable` — отключение по нику/IP/UUID.
- `tdn.reduce` — снижение урона для игрока.
- `tdn.ipreduce` — снижение по нику/IP/UUID.
- `tdn.amplify` — увеличение урона для игрока.
- `tdn.ipamplify` — увеличение по нику/IP/UUID.
- `tdn.status` — просмотр статуса модификатора игрока.

### Команды

- `/tdn disable <игрок> <время> <причина>`
    - **Описание:** Отключает PvP для указанного игрока (UUID-based). Авто-bind UUID к нику. Игрок не может наносить урон другим, но может получать его. Можно указать причину, которая будет показываться игроку при попытке атаковать.
    - **Параметры:**
        - `<игрок>`: Имя игрока (онлайн).
        - `<время>`: Продолжительность действия модификатора. Форматы: `30s` (секунды), `5m` (минуты), `1h` (час), `0` — бессрочно.
        - `<причина>`: Причина отключения (опционально, но рекомендуется для DISABLED).
- `/tdn reduce <игрок> <время>`
    - **Описание:** Снижает урон, наносимый этим игроком, до 1/3 (UUID-based). Авто-bind UUID.
    - **Параметры:**
        - `<игрок>`: Имя игрока (онлайн).
        - `<время>`: Продолжительность действия (`5m`, `0` и т.д.). Причина не указывается.
- `/tdn amplify <игрок> <время>`
    - **Описание:** Все другие игроки наносят этому игроку в 4 раза больше урона (UUID-based). Авто-bind UUID.
    - **Параметры:**
        - `<игрок>`: Имя игрока (онлайн).
        - `<время>`: Продолжительность действия (`5m`, `0` и т.д.). Причина не указывается.
- `/tdn status <игрок>`
    - **Описание:** Показывает текущий модификатор урона игрока, оставшееся время его действия и причину (если есть).
    - **Параметры:** `<игрок>` — имя игрока (онлайн).
- `/tdn reload`
    - **Описание:** Перезагружает конфигурацию плагина из файла, позволяя применить изменения без перезапуска сервера. Очищает и перезагружает все карты (player/nick/IP/UUID/alts).
- `/tdn list`
    - **Описание:** Показывает список всех игроков с активными модификаторами, их типом, оставшимся временем действия и причиной (если применимо). Отображает онлайн/UUID.
- `/tdn clear <игрок>`
    - **Описание:** Снимает все модификаторы урона с указанного игрока (playerMods), возвращая PvP в стандартное состояние. Не трогает nick/IP/UUID.
    - **Параметры:** `<игрок>` — имя игрока (онлайн).
- `/tdn nicklist`
    - **Описание:** Показывает список всех ников с активными модификаторами
